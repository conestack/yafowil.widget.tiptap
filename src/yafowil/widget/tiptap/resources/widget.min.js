!function(t,e,i){"use strict";class s{static create(t,i){let o=e("<button />");return i&&o.append(i),new s(t,o)}constructor(t,e){this.editor=t,this.elem=e,this.ops={},this.on_click=this.on_click.bind(this),this.elem.on("click",this.on_click)}on_click(t){t.preventDefault();for(let t in this.ops)t&&this.ops[t].execute()}insert(t){return this.elem.appendTo(t),this}setName(t){return this.elem.prepend(e("<span />").text(t)),this}setBold(){return this.elem.css("font-weight","bold"),this.ops.boldToggle={execute:()=>{this.editor.commands.toggleBold()}},this}setItalic(){return this.elem.css("font-style","italic"),this.ops.italicToggle={execute:()=>{this.editor.commands.toggleItalic()}},this}setUnderline(){return this.elem.css("text-decoration","underline"),this.ops.underlineToggle={execute:()=>{this.editor.commands.toggleUnderline()}},this}setColor(t){return this.elem.css("text-decoration","underline"),this.ops.colorSet={execute:()=>{this.editor.commands.setColor(t)}},this}setToggle(t,e){this.ops.toggle={execute:()=>{this.active=!this.active,this.active?(this.elem.addClass("active"),t()):(this.elem.removeClass("active"),e())}}}setParagraph(){return this.ops.pToggle={execute:()=>{this.editor.commands.setParagraph()}},this}setHeading(t){return this.ops.headingToggle={execute:()=>{this.editor.commands.toggleHeading({level:t})}},this}setBulletList(){return this.ops.toggleBulletList={execute:()=>{this.editor.commands.toggleBulletList()}},this}setOrderedList(){return this.ops.toggleOrderedList={execute:()=>{this.editor.commands.toggleOrderedList()}},this}setIndent(){return this.ops.addBQ={execute:()=>{this.editor.commands.setBlockquote()}},this}setOutdent(){return this.ops.rmBQ={execute:()=>{this.editor.commands.unsetBlockquote()}},this}}class o extends s{static create(t,i){let s=e("<button />").addClass("drop_btn");return i&&s.append(i),new o(t,s)}constructor(t,i){super(t,i),this.dd_elem=e("<div />").addClass("btn-dropdown").appendTo("body"),this.children=[],this.hide_dropdown=this.hide_dropdown.bind(this),e(document).on("click",this.hide_dropdown)}get active_item(){return this._active_item}set active_item(t){let e=t.elem.children().clone();this.elem.empty().append(e),this._active_item=t}unload(){e(document).off("click",this.hide_dropdown)}hide_dropdown(t){this.dd_elem.is(":visible")&&t.target!==this.dd_elem[0]&&t.target!==this.elem[0]&&0===e(t.target).closest(this.dd_elem).length&&0===e(t.target).closest(this.elem).length&&this.dd_elem.hide()}on_click(t){super.on_click(t),this.dd_elem.css("left",`${this.elem.offset().left}px`).css("top",`${this.elem.offset().top+this.elem.outerHeight()}px`).toggle()}add(t){t.elem.addClass("dropdown-item"),t.elem.on("click",(()=>{this.active_item=t})),this.dd_elem.append(t.elem),this.children.push(t)}}class l{static initialize(t){e("div.tiptap-editor",t).each((function(){new l(e(this),{bold:!0,italic:!0,underline:!0,heading:!0,text_colors:[{name:"blue",color:"#1a21fb"},{name:"lime",color:"#ccff00"},{name:"teal",color:"#2acaea"},{name:"red",color:"#d0060a"}],bulletList:!0,orderedList:!0})}))}constructor(t,l){if(this.elem=t,this.elem.data("tiptap-widget",this),this.editor=new i.Editor({element:this.elem[0],extensions:[i.Document,i.Paragraph,i.Text,i.Underline,i.TextStyle,i.Color,i.Heading,i.BulletList,i.OrderedList,i.ListItem,i.Blockquote,i.Bold,i.Italic,i.Code,i.CodeBlock,i.Image],content:"<p>Hello World!</p>"}),this.editarea=e("div.ProseMirror",this.elem),this.textarea=e("<textarea />").addClass("ProseMirror").appendTo(this.elem),this.buttons_textstyles=e("<div />").addClass("btn-group").prependTo(this.elem),l.bold&&(this.bold_btn=s.create(this.editor,e("<span />").text("B")).insert(this.buttons_textstyles).setBold()),l.italic&&(this.italic_btn=s.create(this.editor,e("<span />").text("i")).insert(this.buttons_textstyles).setItalic()),l.underline&&(this.underline_btn=s.create(this.editor,e("<span />").text("U")).insert(this.buttons_textstyles).setUnderline()),l.heading){this.heading_btn=o.create(this.editor).insert(this.buttons_textstyles);let t=s.create(this.editor,e("<span />").text("Text")).setParagraph();this.heading_btn.add(t);for(let t=1;t<=6;t++){let i=s.create(this.editor,e("<span />").text(`Heading ${t}`)).setHeading(t);this.heading_btn.add(i)}this.heading_btn.active_item=t}if(this.new_html_btn=s.create(this.editor,e('<i class="glyphicon glyphicon-pencil">')).insert(this.buttons_textstyles).setToggle((()=>{let t=this.editor.getHTML();this.editarea.hide(),this.textarea.show().text(t)}),(()=>{let t=this.textarea.val();this.textarea.hide(),this.editarea.show(),this.editor.commands.setContent(t)})),l.text_colors){this.colors_btn=o.create(this.editor).insert(this.buttons_textstyles);for(let t of l.text_colors){let i=e("<div />").addClass("color").css("background-color",t.color),o=s.create(this.editor,i).setName(t.name).setColor(t.color);this.colors_btn.add(o),this.colors_btn.active_item=o}}l.bulletList&&(this.ul_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-list")).insert(this.buttons_textstyles).setBulletList()),l.orderedList&&(this.ul_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-th-list")).insert(this.buttons_textstyles).setOrderedList()),this.indent_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-indent-left")).insert(this.buttons_textstyles).setIndent(),this.indent_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-indent-right")).insert(this.buttons_textstyles).setOutdent(),this.img_btn=o.create(this.editor,e('<i class="glyphicon glyphicon-picture">')).insert(this.buttons_textstyles),this.sub_img_btn=s.create(this.editor,e("<span />").text("submit")),this.img_btn.add(this.sub_img_btn),this.hide_all=this.hide_all.bind(this),this.editor.on("update",this.hide_all)}unload_all(){}hide_all(){e("div.btn-dropdown",this.elem).hide()}}e((function(){void 0!==window.ts?ts.ajax.register(l.initialize,!0):l.initialize()})),t.TiptapWidget=l,Object.defineProperty(t,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.tiptap=t}({},jQuery,tiptap);
//# sourceMappingURL=widget.min.js.map
