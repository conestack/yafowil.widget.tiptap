!function(e,t,i){"use strict";class s{constructor(e,i,s){this.editor=e,this.elem=t("<button />").appendTo(s),this.container_elem=s,this.opts=i,this.on_click=this.on_click.bind(this),this.elem.on("click",this.on_click)}toggle(){this.active=!this.active,this.active?this.elem.addClass("active"):this.elem.removeClass("active")}}class l extends s{constructor(e,i,s){super(e,i,s),this.elem.addClass("drop_btn"),this.dd_elem=t("<div />").addClass("btn-dropdown").appendTo("body"),this.children=[],this.hide_dropdown=this.hide_dropdown.bind(this),t(document).on("click",this.hide_dropdown)}get active_item(){return this._active_item}set active_item(e){let t=e.elem.children().clone();this.elem.empty().append(t),this._active_item=e}unload(){t(document).off("click",this.hide_dropdown)}hide_dropdown(e){this.dd_elem.is(":visible")&&e.target!==this.dd_elem[0]&&e.target!==this.elem[0]&&0===t(e.target).closest(this.dd_elem).length&&0===t(e.target).closest(this.elem).length&&this.dd_elem.hide()}on_click(e){e.preventDefault(),this.dd_elem.css("left",`${this.elem.offset().left}px`).css("top",`${this.elem.offset().top+this.elem.outerHeight()}px`).toggle()}}class d extends s{constructor(e,i,s,l){super(e,i,s,l),this.level=l,t("<span />").text(`Heading ${this.level}`).appendTo(this.elem)}on_click(e){e.preventDefault(),this.editor.commands.toggleHeading({level:this.level})}}class o extends s{constructor(e,i,s){super(e,i,s),t("<span />").text("Text").appendTo(this.elem)}on_click(e){e.preventDefault(),this.editor.commands.setParagraph()}}class n extends s{constructor(e,i,s,l){super(e,i,s,l),this.name=l.name,this.color=l.color,t("<span />").text(this.name).appendTo(this.elem),t("<div />").addClass("color").css("background-color",this.color).appendTo(this.elem)}on_click(e){e.preventDefault(),this.editor.commands.setColor(this.color)}}let a={bold:class extends s{constructor(e,t,i){super(e,t,i),this.elem.text("B").css("font-weight","bold")}on_click(e){e.preventDefault(),this.editor.commands.toggleBold()}},italic:class extends s{constructor(e,t,i){super(e,t,i),this.elem.text("i").css("font-style","italic")}on_click(e){e.preventDefault(),this.editor.commands.toggleItalic()}},underline:class extends s{constructor(e,t,i){super(e,t,i),this.elem.text("U").css("text-decoration","underline")}on_click(e){e.preventDefault(),this.editor.commands.toggleUnderline()}},bullet_list:class extends s{constructor(e,i,s){super(e,i,s),this.elem.append(t("<i />").addClass("glyphicon glyphicon-list"))}on_click(e){e.preventDefault(),this.editor.commands.toggleBulletList()}},ordered_list:class extends s{constructor(e,i,s){super(e,i,s),this.elem.append(t("<i />").addClass("glyphicon glyphicon-th-list"))}on_click(e){e.preventDefault(),this.editor.commands.toggleOrderedList()}},indent:class extends s{constructor(e,i,s){super(e,i,s),this.elem.append(t("<i />").addClass("glyphicon glyphicon-indent-left"))}on_click(e){e.preventDefault(),this.editor.commands.setBlockquote()}},outdent:class extends s{constructor(e,i,s){super(e,i,s),this.elem.append(t("<i />").addClass("glyphicon glyphicon-indent-right"))}on_click(e){e.preventDefault(),this.editor.commands.unsetBlockquote()}},html_edit:class extends s{constructor(e,i,s){super(e,i,s),this.elem.append(t("<i />").addClass("glyphicon glyphicon-pencil")),this.parent=this.elem.closest("div.tiptap-editor"),this.editarea=t("div.ProseMirror",this.parent),this.textarea=t("textarea.ProseMirror",this.parent)}on_click(e){e.preventDefault(),this.toggle(),this.active?(t("button",this.parent).not(this.elem).prop("disabled",!0),this.editarea.hide(),this.textarea.show().text(this.editor.getHTML())):(t("button",this.parent).prop("disabled",!1),this.textarea.hide(),this.editarea.show(),this.editor.commands.setContent(this.textarea.val()))}},heading:class extends l{constructor(e,t,i){super(e,t,i),this.children.push(new o(e,t,this.dd_elem));for(let i=1;i<=6;i++)this.children.push(new d(e,t,this.dd_elem,i));for(let e of this.children)e.elem.addClass("dropdown-item"),e.elem.on("click",(t=>{this.active_item=e}));this.active_item=this.children[0]}},colors:class extends l{constructor(e,t,i){super(e,t,i);for(let i of t)this.children.push(new n(e,t,this.dd_elem,i));for(let e of this.children)e.elem.addClass("dropdown-item"),e.elem.on("click",(t=>{this.active_item=e}));this.active_item=this.children[0]}},image:class extends l{constructor(e,i,s){super(e,i,s),this.elem.append(t("<i />").addClass("glyphicon glyphicon-picture")),this.src_elem=t("<span />").addClass("dropdown-item").append(t("<span />").addClass("name").text("src:")).append(t('<input type="text" />')).appendTo(this.dd_elem),this.alt_elem=t("<span />").addClass("dropdown-item").append(t("<span />").addClass("name").text("alt:")).append(t('<input type="text" />')).appendTo(this.dd_elem),this.title_elem=t("<span />").addClass("dropdown-item").append(t("<span />").addClass("name").text("title:")).append(t('<input type="text" />')).appendTo(this.dd_elem),this.submit_elem=t("<button />").addClass("submit").text("submit").appendTo(this.dd_elem),this.submit=this.submit.bind(this),this.submit_elem.on("click",this.submit)}submit(e){e.preventDefault(),this.editor.commands.setImage({src:t("input",this.src_elem).val(),alt:t("input",this.alt_elem).val(),title:t("input",this.title_elem).val()})}},link:class extends l{constructor(e,i,s){super(e,i,s),this.elem.text("A"),this.href_elem=t("<span />").addClass("dropdown-item").append(t("<span />").addClass("name").text("href:")).append(t('<input type="text" />')).appendTo(this.dd_elem),this.submit_elem=t("<button />").addClass("submit").text("submit").appendTo(this.dd_elem),this.submit=this.submit.bind(this),this.submit_elem.on("click",this.submit)}submit(e){e.preventDefault();let i=t("input",this.href_elem).val();this.editor.commands.setLink({href:i})}}};class r{static initialize(e){t("div.tiptap-editor",e).each((function(){new r(t(this),{bold:{},italic:!0,underline:!0,bullet_list:!0,ordered_list:!0,indent:!0,outdent:!0,html_edit:!0,heading:!0,colors:[{name:"default",color:"#333333"},{name:"blue",color:"#1a21fb"},{name:"lime",color:"#ccff00"},{name:"teal",color:"#2acaea"},{name:"red",color:"#d0060a"}],image:!0,link:!0})}))}constructor(e,s){this.elem=e,this.elem.data("tiptap-widget",this),this.editor=new i.Editor({element:this.elem[0],extensions:[i.Document,i.Paragraph,i.Text,i.Underline,i.TextStyle,i.Color,i.Heading,i.BulletList,i.OrderedList,i.ListItem,i.Blockquote,i.Bold,i.Italic,i.Code,i.CodeBlock,i.Image,i.Link],content:"<p>Hello World!</p>"}),this.editarea=t("div.ProseMirror",this.elem),this.textarea=t("<textarea />").addClass("ProseMirror").appendTo(this.elem),s||(s={}),this.buttons_textstyles=t("<div />").addClass("btn-group").prependTo(this.elem);for(let e in s){let t=s[e];new(0,a[e])(this.editor,t,this.buttons_textstyles)}this.hide_all=this.hide_all.bind(this),this.editor.on("update",this.hide_all)}unload_all(){}hide_all(){t("div.btn-dropdown",this.elem).hide()}}t((function(){void 0!==window.ts?ts.ajax.register(r.initialize,!0):r.initialize()})),e.TiptapWidget=r,Object.defineProperty(e,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.tiptap=e}({},jQuery,tiptap);
//# sourceMappingURL=widget.min.js.map
