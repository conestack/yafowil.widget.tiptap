!function(t,e,i){"use strict";class s{static create(t,i){let n=e("<button />");return new s(t,n,i)}constructor(t,e,i){this.elem=e,this.widget=t,this.ops=i,this.on_click=this.on_click.bind(this),this.elem.on("click",this.on_click)}on_click(t){t.preventDefault(),this.ops&&this.ops.click&&this.ops.click()}}class n extends s{constructor(t,e,i){super(t,e,i),this.do=this.ops.toggle[0].bind(this.widget),this.undo=this.ops.toggle[1].bind(this.widget)}on_click(t){super.on_click(t),this.active=!this.active,this.active?(this.elem.addClass("active"),this.do()):(this.elem.removeClass("active"),this.undo())}}class l extends s{static create(t){let i=e("<button />").addClass("drop_btn");return new l(t,i)}constructor(t,i){super(t,i),this.dd_elem=e("<div />").addClass("btn-dropdown").appendTo(t.elem),this.hide_dropdown=this.hide_dropdown.bind(this),e(document).on("click",this.hide_dropdown)}unload(){e(document).off("click",this.hide_dropdown)}hide_dropdown(t){this.dd_elem.is(":visible")&&t.target!==this.dd_elem[0]&&t.target!==this.elem[0]&&0===e(t.target).closest(this.dd_elem).length&&0===e(t.target).closest(this.elem).length&&this.dd_elem.hide()}on_click(t){super.on_click(t),this.dd_elem.css("transform",`translate(${this.elem.position().left}px, ${this.elem.outerHeight()}px)`),this.dd_elem.toggle()}}class o extends l{static create(t){let i=e("<button />").addClass("drop_btn");return new o(t,i)}constructor(t,i){super(t,i),this.src_input=e("<span />").addClass("dropdown-item").text("source:").append(e('<input type="text" />').addClass("img-source")).appendTo(this.dd_elem),this.title_input=e("<span />").addClass("dropdown-item").text("title:").append(e('<input type="text" />').addClass("img-title")).appendTo(this.dd_elem),this.alt_input=e("<span />").addClass("dropdown-item").text("alt:").append(e('<input type="text" />').addClass("img-alt")).appendTo(this.dd_elem);let n=this.submit_btn_elem=e("<button />").text("submit").appendTo(this.dd_elem);this.submit_btn=new s(t,n),this.submit_btn.elem.on("click",(t=>{let i=e("input.img-source",this.dd_elem).val(),s=e("input.img-alt",this.dd_elem).val(),n=e("input.img-title",this.dd_elem).val();this.widget.editor.commands.setImage({src:i,alt:s,title:n})}))}}class d extends l{static create(t,i){let s=e("<button />").addClass("drop_btn");return new d(t,s,i)}constructor(t,e,i){if(super(t,e),this.children=[],i){for(let t of i)this.add(t);this.active_item=this.children[0]}}get active_item(){return this._active_item}set active_item(t){let e=t.elem.children().clone();this.elem.empty().append(e),this._active_item=t}add(t){t.elem.addClass("dropdown-item"),t.elem.on("click",(()=>{this.active_item=t})),this.dd_elem.append(t.elem),this.children.push(t)}}class a{static initialize(t){e("div.tiptap-editor",t).each((function(){new a(e(this),{bold:!0,italic:!0,underline:!0,heading:!0,text_colors:[{name:"blue",color:"#1a21fb"},{name:"lime",color:"#ccff00"},{name:"teal",color:"#2acaea"},{name:"red",color:"#d0060a"}],bulletList:!0,orderedList:!0})}))}constructor(t,l){if(this.elem=t,this.elem.data("tiptap-widget",this),this.editor=new i.Editor({element:this.elem[0],extensions:[i.Document,i.Paragraph,i.Text,i.Underline,i.TextStyle,i.Color,i.Heading,i.BulletList,i.OrderedList,i.ListItem,i.Blockquote,i.Bold,i.Italic,i.Code,i.CodeBlock,i.Image],content:"<p>Hello World!</p>"}),this.editarea=e("div.ProseMirror",this.elem),this.textarea=e("<textarea />").addClass("ProseMirror").appendTo(this.elem),this.buttons_textstyles=e("<div />").addClass("btn-group").prependTo(this.elem),l.bold){let t=e("<button />").text("B").css("font-weight","bold").appendTo(this.buttons_textstyles);this.bold_btn=new s(this,t,{click:()=>{this.editor.commands.toggleBold()}})}if(l.italic){let t=e("<button />").text("i").css("font-style","italic").appendTo(this.buttons_textstyles);this.italic_btn=new s(this,t,{click:()=>{this.editor.commands.toggleItalic()}})}if(l.underline){let t=e("<button />").text("U").css("text-decoration","underline").appendTo(this.buttons_textstyles);this.underline_btn=s.create(this,t,{click:()=>{this.editor.commands.toggleUnderline()}})}if(l.heading){let t=e("<button />").addClass("drop_btn").insertAfter(this.buttons_textstyles),i=[];const n=e("<button />").append(e("<span />").text("Text"));i.push(new s(this,n,{click:()=>{this.editor.commands.setParagraph()}}));for(let t=1;t<=6;t++){let n=e("<button />").append(e("<span />").text(`Heading ${t}`));i.push(new s(this,n,{click:()=>{this.editor.commands.toggleHeading({level:t})}}))}this.heading_btn=new d(this,t,i)}if(l.text_colors){let t=e("<button />").addClass("drop_btn").insertAfter(this.heading_btn.elem),i=[];for(let t of l.text_colors){let n=e("<span />").text(t.name),l=e("<div />").addClass("color").css("background-color",t.color),o=e("<button />").append(l).append(n).insertAfter(this.buttons_textstyles);i.push(new s(this,o,{click:()=>{this.editor.commands.setColor(t.color)}}))}this.color_btn=new d(this,t,i)}if(l.bulletList){let t=e("<button />").append(e("<i />").addClass("glyphicon glyphicon-list")).insertAfter(this.color_btn.elem);this.ul_btn=new s(this,t,{click:()=>{this.editor.commands.toggleBulletList()}})}if(l.orderedList){let t=e("<button />").append(e("<i />").addClass("glyphicon glyphicon-th-list")).insertAfter(this.ul_btn.elem);this.ol_btn=new s(this,t,{click:()=>{this.editor.commands.toggleOrderedList()}})}let a=e("<button />").append(e("<i />").addClass("glyphicon glyphicon-indent-left")).insertAfter(this.ol_btn.elem);this.indent_btn=new s(this,a,{click:()=>{this.editor.commands.setBlockquote()}});let h=e("<button />").append(e("<i />").addClass("glyphicon glyphicon-indent-right")).insertAfter(this.indent_btn.elem);this.outdent_btn=new s(this,h,{click:()=>{this.editor.commands.unsetBlockquote()}});let c=e("<button />").append(e('<i class="glyphicon glyphicon-pencil">')).insertAfter(this.buttons_textstyles);this.html_btn=new n(this,c,{toggle:[function(){let t=this.editor.getHTML();this.editarea.hide(),this.textarea.show().text(t)},function(){let t=this.textarea.val();this.textarea.hide(),this.editarea.show(),this.editor.commands.setContent(t)}]});let r=e("<button />").append(e('<i class="glyphicon glyphicon-picture">')).insertAfter(this.buttons_textstyles);this.image_btn=new o(this,r),this.hide_all=this.hide_all.bind(this),this.editor.on("update",this.hide_all)}unload_all(){}hide_all(){e("div.btn-dropdown",this.elem).hide()}}e((function(){void 0!==window.ts?ts.ajax.register(a.initialize,!0):a.initialize()})),t.TiptapWidget=a,Object.defineProperty(t,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.tiptap=t}({},jQuery,tiptap);
//# sourceMappingURL=widget.min.js.map
