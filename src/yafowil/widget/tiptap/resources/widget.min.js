!function(t,e,i){"use strict";class s{static create(t,i,o){let d=e("<button />",o);return i&&d.append(i),new s(t,d,o)}constructor(t,e,i){this.editor=t,this.elem=e,this.ops={},this.on_click=this.on_click.bind(this),this.elem.on("click",this.on_click)}on_click(t){t.preventDefault();for(let t in this.ops)t&&this.ops[t].execute()}insert(t){return this.elem.appendTo(t),this}addTo(t,e){return t.add(this,e),this}setName(t){return this.elem.prepend(e("<span />").text(t)),this}set(t){if("function"==typeof t)return this.ops.customFunction={execute:()=>{t()}},this;let e=t.split(", ");return e.includes("bold")&&(this.elem.css("font-weight","bold"),this.ops.boldToggle={execute:()=>{this.editor.commands.toggleBold()}}),e.includes("italic")&&(this.elem.css("font-style","italic"),this.ops.italicToggle={execute:()=>{this.editor.commands.toggleItalic()}}),e.includes("underline")&&(this.elem.css("text-decoration","underline"),this.ops.underlineToggle={execute:()=>{this.editor.commands.toggleUnderline()}}),e.includes("paragraph")&&(this.ops.pToggle={execute:()=>{this.editor.commands.setParagraph()}}),e.includes("bulletList")&&(this.ops.toggleBulletList={execute:()=>{this.editor.commands.toggleBulletList()}}),e.includes("orderedList")&&(this.ops.toggleOrderedList={execute:()=>{this.editor.commands.toggleOrderedList()}}),e.includes("indent")&&(this.ops.addBQ={execute:()=>{this.editor.commands.setBlockquote()}}),e.includes("outdent")&&(this.ops.rmBQ={execute:()=>{this.editor.commands.unsetBlockquote()}}),this}setHeading(t){return this.ops.headingToggle={execute:()=>{this.editor.commands.toggleHeading({level:t})}},this}setColor(t){return this.ops.colorSet={execute:()=>{this.editor.commands.setColor(t)}},this}setToggle(t,e){this.ops.toggle={execute:()=>{this.active=!this.active,this.active?(this.elem.addClass("active"),t()):(this.elem.removeClass("active"),e())}}}setActive(){this.parent&&(this.parent.active_item=this)}}class o extends s{static create(t,i){let s=e("<button />").addClass("drop_btn");return i&&s.append(i),new o(t,s)}constructor(t,i){super(t,i),this.dd_elem=e("<div />").addClass("btn-dropdown").appendTo("body"),this.children=[],this.hide_dropdown=this.hide_dropdown.bind(this),e(document).on("click",this.hide_dropdown)}get active_item(){return this._active_item}set active_item(t){let e=t.elem.children().clone();this.elem.empty().append(e),this._active_item=t}unload(){e(document).off("click",this.hide_dropdown)}hide_dropdown(t){this.dd_elem.is(":visible")&&t.target!==this.dd_elem[0]&&t.target!==this.elem[0]&&0===e(t.target).closest(this.dd_elem).length&&0===e(t.target).closest(this.elem).length&&this.dd_elem.hide()}on_click(t){super.on_click(t),this.dd_elem.css("left",`${this.elem.offset().left}px`).css("top",`${this.elem.offset().top+this.elem.outerHeight()}px`).toggle()}add(t,e){t.parent=this,t.elem.addClass("dropdown-item"),e&&(t.ops.activate={execute:()=>{this.active_item=t}}),t.insert(this.dd_elem),this.children.push(t)}addInput(t){for(let i of t)e("<span />").addClass("dropdown-item").text(`${i}:`).append(e('<input type="text" />').addClass(`img-${i}`)).appendTo(this.dd_elem);return this}}class d{static initialize(t){e("div.tiptap-editor",t).each((function(){new d(e(this),{bold:!0,italic:!0,underline:!0,heading:!0,text_colors:[{name:"blue",color:"#1a21fb"},{name:"lime",color:"#ccff00"},{name:"teal",color:"#2acaea"},{name:"red",color:"#d0060a"}],bulletList:!0,orderedList:!0})}))}constructor(t,d){if(this.elem=t,this.elem.data("tiptap-widget",this),this.editor=new i.Editor({element:this.elem[0],extensions:[i.Document,i.Paragraph,i.Text,i.Underline,i.TextStyle,i.Color,i.Heading,i.BulletList,i.OrderedList,i.ListItem,i.Blockquote,i.Bold,i.Italic,i.Code,i.CodeBlock,i.Image],content:"<p>Hello World!</p>"}),this.editarea=e("div.ProseMirror",this.elem),this.textarea=e("<textarea />").addClass("ProseMirror").appendTo(this.elem),this.buttons_textstyles=e("<div />").addClass("btn-group").prependTo(this.elem),d.bold&&(this.bold_btn=s.create(this.editor,e("<span />").text("B")).insert(this.buttons_textstyles).set("bold")),d.italic&&(this.italic_btn=s.create(this.editor,e("<span />").text("i")).insert(this.buttons_textstyles).set("italic")),d.underline&&(this.underline_btn=s.create(this.editor,e("<span />").text("U")).insert(this.buttons_textstyles).set("underline")),d.heading){this.heading_btn=o.create(this.editor).insert(this.buttons_textstyles),s.create(this.editor,e("<span />",e("body")).text("Text")).addTo(this.heading_btn,!0).set("paragraph");for(let t=1;t<=6;t++)s.create(this.editor,e("<span />").text(`Heading ${t}`)).setHeading(t).addTo(this.heading_btn,!0);this.heading_btn.active_item=this.heading_btn.children[0]}if(this.new_html_btn=s.create(this.editor,e('<i class="glyphicon glyphicon-pencil">')).insert(this.buttons_textstyles).setToggle((()=>{let t=this.editor.getHTML();this.editarea.hide(),this.textarea.show().text(t)}),(()=>{let t=this.textarea.val();this.textarea.hide(),this.editarea.show(),this.editor.commands.setContent(t)})),d.text_colors){this.colors_btn=o.create(this.editor).insert(this.buttons_textstyles);for(let t of d.text_colors){let i=e("<div />").addClass("color").css("background-color",t.color);s.create(this.editor,i).setName(t.name).setColor(t.color).addTo(this.colors_btn,!0)}this.colors_btn.active_item=this.colors_btn.children[0]}d.bulletList&&(this.ul_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-list")).insert(this.buttons_textstyles).set("bulletList")),d.orderedList&&(this.ul_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-th-list")).insert(this.buttons_textstyles).set("orderedList")),this.indent_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-indent-left")).insert(this.buttons_textstyles).set("indent"),this.indent_btn=s.create(this.editor,e("<i />").addClass("glyphicon glyphicon-indent-right")).insert(this.buttons_textstyles).set("outdent"),this.img_btn=o.create(this.editor,e('<i class="glyphicon glyphicon-picture">')).addInput(["source","title","alt"]).insert(this.buttons_textstyles),this.sub_img_btn=s.create(this.editor,e("<span />").text("submit")).addTo(this.img_btn).set((()=>{let t=e("input.img-source",this.dd_elem).val(),i=e("input.img-alt",this.dd_elem).val(),s=e("input.img-title",this.dd_elem).val();this.editor.commands.setImage({src:t,alt:i,title:s})})),this.hide_all=this.hide_all.bind(this),this.editor.on("update",this.hide_all)}unload_all(){}hide_all(){e("div.btn-dropdown",this.elem).hide()}}e((function(){void 0!==window.ts?ts.ajax.register(d.initialize,!0):d.initialize()})),t.TiptapWidget=d,Object.defineProperty(t,"__esModule",{value:!0}),void 0===window.yafowil&&(window.yafowil={}),window.yafowil.tiptap=t}({},jQuery,tiptap);
//# sourceMappingURL=widget.min.js.map
