!function(){"use strict";var t,e;t=void 0,e=function(t,e,n,o,r,s,i,a){function c(t){return"Object"===function(t){return Object.prototype.toString.call(t).slice(8,-1)}(t)&&t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function d(t,e){const n={...t};return c(t)&&c(e)&&Object.keys(e).forEach((o=>{c(e[o])?o in t?n[o]=d(t[o],e[o]):Object.assign(n,{[o]:e[o]}):Object.assign(n,{[o]:e[o]})})),n}function l(t){return"function"==typeof t}function p(t,e,...n){return l(t)?e?t.bind(e)(...n):t(...n):t}function u(t,e,n){return void 0===t.config[e]&&t.parent?u(t.parent,e,n):"function"==typeof t.config[e]?t.config[e].bind({...n,parent:t.parent?u(t.parent,e,n):null}):t.config[e]}class m{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=p(u(this,"addOptions",{name:this.name}))),this.storage=p(u(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new m(t)}configure(t={}){const e=this.extend();return e.options=d(this.options,t),e.storage=p(u(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new m(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=p(u(e,"addOptions",{name:e.name})),e.storage=p(u(e,"addStorage",{name:e.name,options:e.options})),e}}function h(t,e,n){const{from:o,to:r}=e,{blockSeparator:s="\n\n",textSerializers:i={}}=n||{};let a="",c=!0;return t.nodesBetween(o,r,((t,e,n,d)=>{var l;const p=null==i?void 0:i[t.type.name];p?(t.isBlock&&!c&&(a+=s,c=!0),a+=p({node:t,pos:e,parent:n,index:d})):t.isText?(a+=null===(l=null==t?void 0:t.text)||void 0===l?void 0:l.slice(Math.max(o,e)-e,r-e),c=!1):t.isBlock&&!c&&(a+=s,c=!0)})),a}function f(t){return Object.fromEntries(Object.entries(t.nodes).filter((([,t])=>t.spec.toText)).map((([t,e])=>[t,e.spec.toText])))}const g=m.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new e.Plugin({key:new e.PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:o,selection:r}=e,{ranges:s}=r,i=Math.min(...s.map((t=>t.$from.pos))),a=Math.max(...s.map((t=>t.$to.pos)));return h(o,{from:i,to:a},{textSerializers:f(n)})}}})]}});var b=Object.freeze({__proto__:null,blur:()=>({editor:t,view:e})=>(requestAnimationFrame((()=>{var n;t.isDestroyed||(e.dom.blur(),null===(n=null===window||void 0===window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())})),!0)}),y=Object.freeze({__proto__:null,clearContent:(t=!1)=>({commands:e})=>e.setContent("",t)}),v=Object.freeze({__proto__:null,clearNodes:()=>({state:t,tr:e,dispatch:o})=>{const{selection:r}=e,{ranges:s}=r;return!o||(s.forEach((({$from:o,$to:r})=>{t.doc.nodesBetween(o.pos,r.pos,((t,o)=>{if(t.type.isText)return;const{doc:r,mapping:s}=e,i=r.resolve(s.map(o)),a=r.resolve(s.map(o+t.nodeSize)),c=i.blockRange(a);if(!c)return;const d=n.liftTarget(c);if(t.type.isTextblock){const{defaultType:t}=i.parent.contentMatchAt(i.index());e.setNodeMarkup(c.start,t)}(d||0===d)&&e.lift(c,d)}))})),!0)}}),x=Object.freeze({__proto__:null,command:t=>e=>t(e)}),w=Object.freeze({__proto__:null,createParagraphNear:()=>({state:t,dispatch:e})=>o.createParagraphNear(t,e)});function k(t,e){if("string"==typeof t){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var _=Object.freeze({__proto__:null,deleteNode:t=>({tr:e,state:n,dispatch:o})=>{const r=k(t,n.schema),s=e.selection.$anchor;for(let t=s.depth;t>0;t-=1)if(s.node(t).type===r){if(o){const n=s.before(t),o=s.after(t);e.delete(n,o).scrollIntoView()}return!0}return!1}}),M=Object.freeze({__proto__:null,deleteRange:t=>({tr:e,dispatch:n})=>{const{from:o,to:r}=t;return n&&e.delete(o,r),!0}}),S=Object.freeze({__proto__:null,deleteSelection:()=>({state:t,dispatch:e})=>o.deleteSelection(t,e)}),O=Object.freeze({__proto__:null,enter:()=>({commands:t})=>t.keyboardShortcut("Enter")}),E=Object.freeze({__proto__:null,exitCode:()=>({state:t,dispatch:e})=>o.exitCode(t,e)});function T(t,e){if("string"==typeof t){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}function j(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function P(t,e,n={strict:!0}){const o=Object.keys(e);return!o.length||o.every((o=>n.strict?e[o]===t[o]:j(e[o])?e[o].test(t[o]):e[o]===t[o]))}function C(t,e,n={}){return t.find((t=>t.type===e&&P(t.attrs,n)))}function N(t,e,n={}){return!!C(t,e,n)}function A(t,e,n={}){if(!t||!e)return;const o=t.parent.childAfter(t.parentOffset);if(!o.node)return;const r=C(o.node.marks,e,n);if(!r)return;let s=t.index(),i=t.start()+o.offset,a=s+1,c=i+o.node.nodeSize;for(C(o.node.marks,e,n);s>0&&r.isInSet(t.parent.child(s-1).marks);)s-=1,i-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&N(t.parent.child(a).marks,e,n);)c+=t.parent.child(a).nodeSize,a+=1;return{from:i,to:c}}var z=Object.freeze({__proto__:null,extendMarkRange:(t,n={})=>({tr:o,state:r,dispatch:s})=>{const i=T(t,r.schema),{doc:a,selection:c}=o,{$from:d,from:l,to:p}=c;if(s){const t=A(d,i,n);if(t&&t.from<=l&&t.to>=p){const n=e.TextSelection.create(a,t.from,t.to);o.setSelection(n)}}return!0}}),R=Object.freeze({__proto__:null,first:t=>e=>{const n="function"==typeof t?t(e):t;for(let t=0;t<n.length;t+=1)if(n[t](e))return!0;return!1}});function $(t){return t&&"object"==typeof t&&!Array.isArray(t)&&!function(t){var e;return"class"===(null===(e=t.constructor)||void 0===e?void 0:e.toString().substring(0,5))}(t)}function B(t){return $(t)&&t instanceof e.TextSelection}function I(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function D(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function L(t,n=null){if(!n)return null;if("start"===n||!0===n)return e.Selection.atStart(t);if("end"===n)return e.Selection.atEnd(t);if("all"===n)return e.TextSelection.create(t,0,t.content.size);const o=e.Selection.atStart(t).from,r=e.Selection.atEnd(t).to,s=D(n,o,r),i=D(n,o,r);return e.TextSelection.create(t,s,i)}var F=Object.freeze({__proto__:null,focus:(t=null,e)=>({editor:n,view:o,tr:r,dispatch:s})=>{e={scrollIntoView:!0,...e};const i=()=>{I()&&o.dom.focus(),requestAnimationFrame((()=>{n.isDestroyed||(o.focus(),(null==e?void 0:e.scrollIntoView)&&n.commands.scrollIntoView())}))};if(o.hasFocus()&&null===t||!1===t)return!0;if(s&&null===t&&!B(n.state.selection))return i(),!0;const a=L(n.state.doc,t)||n.state.selection,c=n.state.selection.eq(a);return s&&(c||r.setSelection(a),c&&r.storedMarks&&r.setStoredMarks(r.storedMarks),i()),!0}}),H=Object.freeze({__proto__:null,forEach:(t,e)=>n=>t.every(((t,o)=>e(t,{...n,index:o})))}),K=Object.freeze({__proto__:null,insertContent:(t,e)=>({tr:n,commands:o})=>o.insertContentAt({from:n.selection.from,to:n.selection.to},t,e)});function V(t){const e=`<body>${t}</body>`;return(new window.DOMParser).parseFromString(e,"text/html").body}function W(t,e,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof t&&null!==t)try{return Array.isArray(t)?r.Fragment.fromArray(t.map((t=>e.nodeFromJSON(t)))):e.nodeFromJSON(t)}catch(o){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),W("",e,n)}if("string"==typeof t){const o=r.DOMParser.fromSchema(e);return n.slice?o.parseSlice(V(t),n.parseOptions).content:o.parse(V(t),n.parseOptions)}return W("",e,n)}var J=Object.freeze({__proto__:null,insertContentAt:(t,o,r)=>({tr:s,dispatch:i,editor:a})=>{if(i){r={parseOptions:{},updateSelection:!0,...r};const i=W(o,a.schema,{parseOptions:{preserveWhitespace:"full",...r.parseOptions}});if("<>"===i.toString())return!0;let{from:c,to:d}="number"==typeof t?{from:t,to:t}:t,l=!0,p=!0;if((i.toString().startsWith("<")?i:[i]).forEach((t=>{t.check(),l=!!l&&t.isText&&0===t.marks.length,p=!!p&&t.isBlock})),c===d&&p){const{parent:t}=s.doc.resolve(c);t.isTextblock&&!t.type.spec.code&&!t.childCount&&(c-=1,d+=1)}l?s.insertText(o,c,d):s.replaceWith(c,d,i),r.updateSelection&&function(t,o,r){const s=t.steps.length-1;if(s<o)return;const i=t.steps[s];if(!(i instanceof n.ReplaceStep||i instanceof n.ReplaceAroundStep))return;const a=t.mapping.maps[s];let c=0;a.forEach(((t,e,n,o)=>{0===c&&(c=o)})),t.setSelection(e.Selection.near(t.doc.resolve(c),r))}(s,s.steps.length-1,-1)}return!0}}),q=Object.freeze({__proto__:null,joinBackward:()=>({state:t,dispatch:e})=>o.joinBackward(t,e)}),G=Object.freeze({__proto__:null,joinForward:()=>({state:t,dispatch:e})=>o.joinForward(t,e)});const U="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);var X=Object.freeze({__proto__:null,keyboardShortcut:t=>({editor:e,view:n,tr:o,dispatch:r})=>{const s=function(t){const e=t.split(/-(?!$)/);let n,o,r,s,i=e[e.length-1];"Space"===i&&(i=" ");for(let t=0;t<e.length-1;t+=1){const i=e[t];if(/^(cmd|meta|m)$/i.test(i))s=!0;else if(/^a(lt)?$/i.test(i))n=!0;else if(/^(c|ctrl|control)$/i.test(i))o=!0;else if(/^s(hift)?$/i.test(i))r=!0;else{if(!/^mod$/i.test(i))throw new Error(`Unrecognized modifier name: ${i}`);U?s=!0:o=!0}}return n&&(i=`Alt-${i}`),o&&(i=`Ctrl-${i}`),s&&(i=`Meta-${i}`),r&&(i=`Shift-${i}`),i}(t).split(/-(?!$)/),i=s.find((t=>!["Alt","Ctrl","Meta","Shift"].includes(t))),a=new KeyboardEvent("keydown",{key:"Space"===i?" ":i,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction((()=>{n.someProp("handleKeyDown",(t=>t(n,a)))}));return null==c||c.steps.forEach((t=>{const e=t.map(o.mapping);e&&r&&o.maybeStep(e)})),!0}});function Y(t,e,n={}){const{from:o,to:r,empty:s}=t.selection,i=e?k(e,t.schema):null,a=[];t.doc.nodesBetween(o,r,((t,e)=>{if(t.isText)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize);a.push({node:t,from:n,to:s})}));const c=r-o,d=a.filter((t=>!i||i.name===t.node.type.name)).filter((t=>P(t.node.attrs,n,{strict:!1})));return s?!!d.length:d.reduce(((t,e)=>t+e.to-e.from),0)>=c}var Q=Object.freeze({__proto__:null,lift:(t,e={})=>({state:n,dispatch:r})=>!!Y(n,k(t,n.schema),e)&&o.lift(n,r)}),Z=Object.freeze({__proto__:null,liftEmptyBlock:()=>({state:t,dispatch:e})=>o.liftEmptyBlock(t,e)}),tt=Object.freeze({__proto__:null,liftListItem:t=>({state:e,dispatch:n})=>{const o=k(t,e.schema);return s.liftListItem(o)(e,n)}}),et=Object.freeze({__proto__:null,newlineInCode:()=>({state:t,dispatch:e})=>o.newlineInCode(t,e)});function nt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function ot(t,e){const n="string"==typeof e?[e]:e;return Object.keys(t).reduce(((e,o)=>(n.includes(o)||(e[o]=t[o]),e)),{})}var rt=Object.freeze({__proto__:null,resetAttributes:(t,e)=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=nt("string"==typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(s=k(t,o.schema)),"mark"===a&&(i=T(t,o.schema)),r&&n.selection.ranges.forEach((t=>{o.doc.nodesBetween(t.$from.pos,t.$to.pos,((t,o)=>{s&&s===t.type&&n.setNodeMarkup(o,void 0,ot(t.attrs,e)),i&&t.marks.length&&t.marks.forEach((r=>{i===r.type&&n.addMark(o,o+t.nodeSize,i.create(ot(r.attrs,e)))}))}))})),!0)}}),st=Object.freeze({__proto__:null,scrollIntoView:()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0)}),it=Object.freeze({__proto__:null,selectAll:()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size})}),at=Object.freeze({__proto__:null,selectNodeBackward:()=>({state:t,dispatch:e})=>o.selectNodeBackward(t,e)}),ct=Object.freeze({__proto__:null,selectNodeForward:()=>({state:t,dispatch:e})=>o.selectNodeForward(t,e)}),dt=Object.freeze({__proto__:null,selectParentNode:()=>({state:t,dispatch:e})=>o.selectParentNode(t,e)});function lt(t,e,n={}){return W(t,e,{slice:!1,parseOptions:n})}var pt=Object.freeze({__proto__:null,setContent:(t,n=!1,o={})=>({tr:r,editor:s,dispatch:i})=>{const{doc:a}=r,c=lt(t,s.schema,o),d=e.TextSelection.create(a,0,a.content.size);return i&&r.setSelection(d).replaceSelectionWith(c,!1).setMeta("preventUpdate",!n),!0}});function ut(t,e){const n=T(e,t.schema),{from:o,to:r,empty:s}=t.selection,i=[];s?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(o,r,(t=>{i.push(...t.marks)}));const a=i.find((t=>t.type.name===n.name));return a?{...a.attrs}:{}}var mt=Object.freeze({__proto__:null,setMark:(t,e={})=>({tr:n,state:o,dispatch:r})=>{const{selection:s}=n,{empty:i,ranges:a}=s,c=T(t,o.schema);if(r)if(i){const t=ut(o,c);n.addStoredMark(c.create({...t,...e}))}else a.forEach((t=>{const r=t.$from.pos,s=t.$to.pos;o.doc.nodesBetween(r,s,((t,o)=>{const i=Math.max(o,r),a=Math.min(o+t.nodeSize,s);t.marks.find((t=>t.type===c))?t.marks.forEach((t=>{c===t.type&&n.addMark(i,a,c.create({...t.attrs,...e}))})):n.addMark(i,a,c.create(e))}))}));return!0}}),ht=Object.freeze({__proto__:null,setMeta:(t,e)=>({tr:n})=>(n.setMeta(t,e),!0)}),ft=Object.freeze({__proto__:null,setNode:(t,e={})=>({state:n,dispatch:r,chain:s})=>{const i=k(t,n.schema);return i.isTextblock?s().command((({commands:t})=>!!o.setBlockType(i,e)(n)||t.clearNodes())).command((({state:t})=>o.setBlockType(i,e)(t,r))).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}}),gt=Object.freeze({__proto__:null,setNodeSelection:t=>({tr:n,dispatch:o})=>{if(o){const{doc:o}=n,r=e.Selection.atStart(o).from,s=e.Selection.atEnd(o).to,i=D(t,r,s),a=e.NodeSelection.create(o,i);n.setSelection(a)}return!0}}),bt=Object.freeze({__proto__:null,setTextSelection:t=>({tr:n,dispatch:o})=>{if(o){const{doc:o}=n,{from:r,to:s}="number"==typeof t?{from:t,to:t}:t,i=e.Selection.atStart(o).from,a=e.Selection.atEnd(o).to,c=D(r,i,a),d=D(s,i,a),l=e.TextSelection.create(o,c,d);n.setSelection(l)}return!0}}),yt=Object.freeze({__proto__:null,sinkListItem:t=>({state:e,dispatch:n})=>{const o=k(t,e.schema);return s.sinkListItem(o)(e,n)}});function vt(t,e,n){return Object.fromEntries(Object.entries(n).filter((([n])=>{const o=t.find((t=>t.type===e&&t.name===n));return!!o&&o.attribute.keepOnSplit})))}function xt(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const o=n.filter((t=>null==e?void 0:e.includes(t.type.name)));t.tr.ensureMarks(o)}}var wt=Object.freeze({__proto__:null,splitBlock:({keepMarks:t=!0}={})=>({tr:o,state:r,dispatch:s,editor:i})=>{const{selection:a,doc:c}=o,{$from:d,$to:l}=a,p=vt(i.extensionManager.attributes,d.node().type.name,d.node().attrs);if(a instanceof e.NodeSelection&&a.node.isBlock)return!(!d.parentOffset||!n.canSplit(c,d.pos)||(s&&(t&&xt(r,i.extensionManager.splittableMarks),o.split(d.pos).scrollIntoView()),0));if(!d.parent.isBlock)return!1;if(s){const s=l.parentOffset===l.parent.content.size;a instanceof e.TextSelection&&o.deleteSelection();const c=0===d.depth?void 0:function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(d.node(-1).contentMatchAt(d.indexAfter(-1)));let u=s&&c?[{type:c,attrs:p}]:void 0,m=n.canSplit(o.doc,o.mapping.map(d.pos),1,u);if(u||m||!n.canSplit(o.doc,o.mapping.map(d.pos),1,c?[{type:c}]:void 0)||(m=!0,u=c?[{type:c,attrs:p}]:void 0),m&&(o.split(o.mapping.map(d.pos),1,u),c&&!s&&!d.parentOffset&&d.parent.type!==c)){const t=o.mapping.map(d.before()),e=o.doc.resolve(t);d.node(-1).canReplaceWith(e.index(),e.index()+1,c)&&o.setNodeMarkup(o.mapping.map(d.before()),c)}t&&xt(r,i.extensionManager.splittableMarks),o.scrollIntoView()}return!0}}),kt=Object.freeze({__proto__:null,splitListItem:t=>({tr:o,state:s,dispatch:i,editor:a})=>{var c;const d=k(t,s.schema),{$from:l,$to:p}=s.selection,u=s.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(p))return!1;const m=l.node(-1);if(m.type!==d)return!1;const h=a.extensionManager.attributes;if(0===l.parent.content.size&&l.node(-1).childCount===l.indexAfter(-1)){if(2===l.depth||l.node(-3).type!==d||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let t=r.Fragment.empty;const n=l.index(-1)?1:l.index(-2)?2:3;for(let e=l.depth-n;e>=l.depth-3;e-=1)t=r.Fragment.from(l.node(e).copy(t));const s=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,i=vt(h,l.node().type.name,l.node().attrs),a=(null===(c=d.contentMatch.defaultType)||void 0===c?void 0:c.createAndFill(i))||void 0;t=t.append(r.Fragment.from(d.createAndFill(null,a)||void 0));const p=l.before(l.depth-(n-1));o.replace(p,l.after(-s),new r.Slice(t,4-n,0));let u=-1;o.doc.nodesBetween(p,o.doc.content.size,((t,e)=>{if(u>-1)return!1;t.isTextblock&&0===t.content.size&&(u=e+1)})),u>-1&&o.setSelection(e.TextSelection.near(o.doc.resolve(u))),o.scrollIntoView()}return!0}const f=p.pos===l.end()?m.contentMatchAt(0).defaultType:null,g=vt(h,m.type.name,m.attrs),b=vt(h,l.node().type.name,l.node().attrs);o.delete(l.pos,p.pos);const y=f?[{type:d,attrs:g},{type:f,attrs:b}]:[{type:d,attrs:g}];return!!n.canSplit(o.doc,l.pos,2)&&(i&&o.split(l.pos,2,y).scrollIntoView(),!0)}});function _t(t,e){for(let n=t.depth;n>0;n-=1){const o=t.node(n);if(e(o))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:o}}}function Mt(t){return e=>_t(e.$from,t)}function St(t){return{baseExtensions:t.filter((t=>"extension"===t.type)),nodeExtensions:t.filter((t=>"node"===t.type)),markExtensions:t.filter((t=>"mark"===t.type))}}function Ot(t,e){const{nodeExtensions:n}=St(e),o=n.find((e=>e.name===t));if(!o)return!1;const r=p(u(o,"group",{name:o.name,options:o.options,storage:o.storage}));return"string"==typeof r&&r.split(" ").includes("list")}const Et=(t,e)=>{const o=Mt((t=>t.type===e))(t.selection);if(!o)return!0;const r=t.doc.resolve(Math.max(0,o.pos-1)).before(o.depth);if(void 0===r)return!0;const s=t.doc.nodeAt(r);return o.node.type!==(null==s?void 0:s.type)||!n.canJoin(t.doc,o.pos)||(t.join(o.pos),!0)},Tt=(t,e)=>{const o=Mt((t=>t.type===e))(t.selection);if(!o)return!0;const r=t.doc.resolve(o.start).after(o.depth);if(void 0===r)return!0;const s=t.doc.nodeAt(r);return o.node.type!==(null==s?void 0:s.type)||!n.canJoin(t.doc,r)||(t.join(r),!0)};var jt=Object.freeze({__proto__:null,toggleList:(t,e)=>({editor:n,tr:o,state:r,dispatch:s,chain:i,commands:a,can:c})=>{const{extensions:d}=n.extensionManager,l=k(t,r.schema),p=k(e,r.schema),{selection:u}=r,{$from:m,$to:h}=u,f=m.blockRange(h);if(!f)return!1;const g=Mt((t=>Ot(t.type.name,d)))(u);if(f.depth>=1&&g&&f.depth-g.depth<=1){if(g.node.type===l)return a.liftListItem(p);if(Ot(g.node.type.name,d)&&l.validContent(g.node.content)&&s)return i().command((()=>(o.setNodeMarkup(g.pos,l),!0))).command((()=>Et(o,l))).command((()=>Tt(o,l))).run()}return i().command((()=>!!c().wrapInList(l)||a.clearNodes())).wrapInList(l).command((()=>Et(o,l))).command((()=>Tt(o,l))).run()}});function Pt(t,e,n={}){const{empty:o,ranges:r}=t.selection,s=e?T(e,t.schema):null;if(o)return!!(t.storedMarks||t.selection.$from.marks()).filter((t=>!s||s.name===t.type.name)).find((t=>P(t.attrs,n,{strict:!1})));let i=0;const a=[];if(r.forEach((({$from:e,$to:n})=>{const o=e.pos,r=n.pos;t.doc.nodesBetween(o,r,((t,e)=>{if(!t.isText&&!t.marks.length)return;const n=Math.max(o,e),s=Math.min(r,e+t.nodeSize);i+=s-n,a.push(...t.marks.map((t=>({mark:t,from:n,to:s}))))}))})),0===i)return!1;const c=a.filter((t=>!s||s.name===t.mark.type.name)).filter((t=>P(t.mark.attrs,n,{strict:!1}))).reduce(((t,e)=>t+e.to-e.from),0),d=a.filter((t=>!s||t.mark.type!==s&&t.mark.type.excludes(s))).reduce(((t,e)=>t+e.to-e.from),0);return(c>0?c+d:c)>=i}var Ct=Object.freeze({__proto__:null,toggleMark:(t,e={},n={})=>({state:o,commands:r})=>{const{extendEmptyMarkRange:s=!1}=n,i=T(t,o.schema);return Pt(o,i,e)?r.unsetMark(i,{extendEmptyMarkRange:s}):r.setMark(i,e)}}),Nt=Object.freeze({__proto__:null,toggleNode:(t,e,n={})=>({state:o,commands:r})=>{const s=k(t,o.schema),i=k(e,o.schema);return Y(o,s,n)?r.setNode(i):r.setNode(s,n)}}),At=Object.freeze({__proto__:null,toggleWrap:(t,e={})=>({state:n,commands:o})=>{const r=k(t,n.schema);return Y(n,r,e)?o.lift(r):o.wrapIn(r,e)}}),zt=Object.freeze({__proto__:null,undoInputRule:()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let o=0;o<n.length;o+=1){const r=n[o];let s;if(r.spec.isInputRules&&(s=r.getState(t))){if(e){const e=t.tr,n=s.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(s.text){const n=e.doc.resolve(s.from).marks();e.replaceWith(s.from,s.to,t.schema.text(s.text,n))}else e.delete(s.from,s.to)}return!0}}return!1}}),Rt=Object.freeze({__proto__:null,unsetAllMarks:()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:o,ranges:r}=n;return o||e&&r.forEach((e=>{t.removeMark(e.$from.pos,e.$to.pos)})),!0}}),$t=Object.freeze({__proto__:null,unsetMark:(t,e={})=>({tr:n,state:o,dispatch:r})=>{var s;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,c=T(t,o.schema),{$from:d,empty:l,ranges:p}=a;if(!r)return!0;if(l&&i){let{from:t,to:e}=a;const o=null===(s=d.marks().find((t=>t.type===c)))||void 0===s?void 0:s.attrs,r=A(d,c,o);r&&(t=r.from,e=r.to),n.removeMark(t,e,c)}else p.forEach((t=>{n.removeMark(t.$from.pos,t.$to.pos,c)}));return n.removeStoredMark(c),!0}}),Bt=Object.freeze({__proto__:null,updateAttributes:(t,e={})=>({tr:n,state:o,dispatch:r})=>{let s=null,i=null;const a=nt("string"==typeof t?t:t.name,o.schema);return!!a&&("node"===a&&(s=k(t,o.schema)),"mark"===a&&(i=T(t,o.schema)),r&&n.selection.ranges.forEach((t=>{const r=t.$from.pos,a=t.$to.pos;o.doc.nodesBetween(r,a,((t,o)=>{s&&s===t.type&&n.setNodeMarkup(o,void 0,{...t.attrs,...e}),i&&t.marks.length&&t.marks.forEach((s=>{if(i===s.type){const c=Math.max(o,r),d=Math.min(o+t.nodeSize,a);n.addMark(c,d,i.create({...s.attrs,...e}))}}))}))})),!0)}}),It=Object.freeze({__proto__:null,wrapIn:(t,e={})=>({state:n,dispatch:r})=>{const s=k(t,n.schema);return o.wrapIn(s,e)(n,r)}}),Dt=Object.freeze({__proto__:null,wrapInList:(t,e={})=>({state:n,dispatch:o})=>{const r=k(t,n.schema);return s.wrapInList(r,e)(n,o)}});const Lt=m.create({name:"commands",addCommands:()=>({...b,...y,...v,...x,...w,..._,...M,...S,...O,...E,...z,...R,...F,...H,...K,...J,...q,...G,...X,...Q,...Z,...tt,...et,...rt,...st,...it,...at,...ct,...dt,...pt,...mt,...ht,...ft,...gt,...bt,...yt,...wt,...kt,...jt,...Ct,...Nt,...At,...zt,...Rt,...$t,...Bt,...It,...Dt})}),Ft=m.create({name:"editable",addProseMirrorPlugins(){return[new e.Plugin({key:new e.PluginKey("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ht=m.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new e.Plugin({key:new e.PluginKey("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const o=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1},blur:(e,n)=>{t.isFocused=!1;const o=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(o),!1}}}})]}});function Kt(t){const{state:e,transaction:n}=t;let{selection:o}=n,{doc:r}=n,{storedMarks:s}=n;return{...e,schema:e.schema,plugins:e.plugins,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return o},get doc(){return r},get tr(){return o=n.selection,r=n.doc,s=n.storedMarks,n}}}class Vt{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:o}=e,{tr:r}=n,s=this.buildProps(r);return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,(...t)=>{const n=e(...t)(s);return r.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(r),n}])))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o,i=[],a=!!t,c=t||r.tr,d={...Object.fromEntries(Object.entries(n).map((([t,n])=>[t,(...t)=>{const o=this.buildProps(c,e),r=n(...t)(o);return i.push(r),d}]))),run:()=>(a||!e||c.getMeta("preventDispatch")||this.hasCustomState||s.dispatch(c),i.every((t=>!0===t)))};return d}createCan(t){const{rawCommands:e,state:n}=this,o=void 0,r=t||n.tr,s=this.buildProps(r,o),i=Object.fromEntries(Object.entries(e).map((([t,e])=>[t,(...t)=>e(...t)({...s,dispatch:o})])));return{...i,chain:()=>this.createChain(r,o)}}buildProps(t,e=!0){const{rawCommands:n,editor:o,state:r}=this,{view:s}=o;r.storedMarks&&t.setStoredMarks(r.storedMarks);const i={tr:t,editor:o,view:s,state:Kt({state:r,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map((([t,e])=>[t,(...t)=>e(...t)(i)])))}};return i}}const Wt=m.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first((({commands:t})=>[()=>t.undoInputRule(),()=>t.command((({tr:n})=>{const{selection:o,doc:r}=n,{empty:s,$anchor:i}=o,{pos:a,parent:c}=i,d=e.Selection.atStart(r).from===a;return!(!(s&&d&&c.type.isTextblock)||c.textContent.length)&&t.clearNodes()})),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()])),n=()=>this.editor.commands.first((({commands:t})=>[()=>t.deleteSelection(),()=>t.joinForward(),()=>t.selectNodeForward()]));return{Enter:()=>this.editor.commands.first((({commands:t})=>[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()])),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:n,"Mod-Delete":n,"Mod-a":()=>this.editor.commands.selectAll()}},addProseMirrorPlugins(){return[new e.Plugin({key:new e.PluginKey("clearDocument"),appendTransaction:(t,n,o)=>{if(!t.some((t=>t.docChanged))||n.doc.eq(o.doc))return;const{empty:r,from:s,to:i}=n.selection,a=e.Selection.atStart(n.doc).from,c=e.Selection.atEnd(n.doc).to,d=s===a&&i===c,l=0===o.doc.textBetween(0,o.doc.content.size," "," ").length;if(r||!d||!l)return;const p=o.tr,u=Kt({state:o,transaction:p}),{commands:m}=new Vt({editor:this.editor,state:u});return m.clearNodes(),p.steps.length?p:void 0}})]}}),Jt=m.create({name:"tabindex",addProseMirrorPlugins:()=>[new e.Plugin({key:new e.PluginKey("tabindex"),props:{attributes:{tabindex:"0"}}})]});var qt=Object.freeze({__proto__:null,ClipboardTextSerializer:g,Commands:Lt,Editable:Ft,FocusEvents:Ht,Keymap:Wt,Tabindex:Jt});function Gt(t,e){const n=k(e,t.schema),{from:o,to:r}=t.selection,s=[];t.doc.nodesBetween(o,r,(t=>{s.push(t)}));const i=s.reverse().find((t=>t.type.name===n.name));return i?{...i.attrs}:{}}function Ut(t,e){const n=nt("string"==typeof e?e:e.name,t.schema);return"node"===n?Gt(t,e):"mark"===n?ut(t,e):{}}function Xt(t,e,n={}){if(!e)return Y(t,null,n)||Pt(t,null,n);const o=nt(e,t.schema);return"node"===o?Y(t,e,n):"mark"===o&&Pt(t,e,n)}function Yt(t,e){const n=r.DOMSerializer.fromSchema(e).serializeFragment(t),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(n),o.innerHTML}function Qt(t,e){return h(t,{from:0,to:t.content.size},e)}function Zt(t){var e;const n=null===(e=t.type.createAndFill())||void 0===e?void 0:e.toJSON(),o=t.toJSON();return JSON.stringify(n)===JSON.stringify(o)}class te{constructor(t){this.find=t.find,this.handler=t.handler}}function ee(t){var e;const{editor:n,from:o,to:r,text:s,rules:i,plugin:a}=t,{view:c}=n;if(c.composing)return!1;const d=c.state.doc.resolve(o);if(d.parent.type.spec.code||(null===(e=d.nodeBefore||d.nodeAfter)||void 0===e?void 0:e.marks.find((t=>t.type.spec.code))))return!1;let l=!1;const p=d.parent.textBetween(Math.max(0,d.parentOffset-500),d.parentOffset,void 0," ")+s;return i.forEach((t=>{if(l)return;const e=((t,e)=>{if(j(e))return e.exec(t);const n=e(t);if(!n)return null;const o=[];return o.push(n.text),o.index=n.index,o.input=t,o.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),o.push(n.replaceWith)),o})(p,t.find);if(!e)return;const i=c.state.tr,d=Kt({state:c.state,transaction:i}),u={from:o-(e[0].length-s.length),to:r},{commands:m,chain:h,can:f}=new Vt({editor:n,state:d});null!==t.handler({state:d,range:u,match:e,commands:m,chain:h,can:f})&&i.steps.length&&(i.setMeta(a,{transform:i,from:o,to:r,text:s}),c.dispatch(i),l=!0)})),l}function ne(t){const{editor:n,rules:o}=t,r=new e.Plugin({state:{init:()=>null,apply(t,e){const n=t.getMeta(this);return n||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:(t,e,s,i)=>ee({editor:n,from:e,to:s,text:i,rules:o,plugin:r}),handleDOMEvents:{compositionend:t=>(setTimeout((()=>{const{$cursor:e}=t.state.selection;e&&ee({editor:n,from:e.pos,to:e.pos,text:"",rules:o,plugin:r})})),!1)},handleKeyDown(t,e){if("Enter"!==e.key)return!1;const{$cursor:s}=t.state.selection;return!!s&&ee({editor:n,from:s.pos,to:s.pos,text:"\n",rules:o,plugin:r})}},isInputRules:!0});return r}class oe{constructor(t){this.find=t.find,this.handler=t.handler}}function re(t){const{editor:e,state:n,from:o,to:r,rule:s}=t,{commands:i,chain:a,can:c}=new Vt({editor:e,state:n}),d=[];return n.doc.nodesBetween(o,r,((t,e)=>{if(!t.isTextblock||t.type.spec.code)return;const l=Math.max(o,e),p=Math.min(r,e+t.content.size);((t,e)=>{if(j(e))return[...t.matchAll(e)];const n=e(t);return n?n.map((e=>{const n=[];return n.push(e.text),n.index=e.index,n.input=t,n.data=e.data,e.replaceWith&&(e.text.includes(e.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(e.replaceWith)),n})):[]})(t.textBetween(l-e,p-e,void 0,"￼"),s.find).forEach((t=>{if(void 0===t.index)return;const e=l+t.index+1,o=e+t[0].length,r={from:n.tr.mapping.map(e),to:n.tr.mapping.map(o)},p=s.handler({state:n,range:r,match:t,commands:i,chain:a,can:c});d.push(p)}))})),d.every((t=>null!==t))}function se(t){const{editor:n,rules:o}=t;let r=null,s=!1,i=!1;return o.map((t=>new e.Plugin({view(t){const e=e=>{var n;r=(null===(n=t.dom.parentElement)||void 0===n?void 0:n.contains(e.target))?t.dom.parentElement:null};return window.addEventListener("dragstart",e),{destroy(){window.removeEventListener("dragstart",e)}}},props:{handleDOMEvents:{drop:t=>(i=r===t.dom.parentElement,!1),paste:(t,e)=>{var n;const o=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return s=!!(null==o?void 0:o.includes("data-pm-slice")),!1}}},appendTransaction:(e,o,r)=>{const a=e[0],c="paste"===a.getMeta("uiEvent")&&!s,d="drop"===a.getMeta("uiEvent")&&!i;if(!c&&!d)return;const l=o.doc.content.findDiffStart(r.doc.content),p=o.doc.content.findDiffEnd(r.doc.content);if("number"!=typeof l||!p||l===p.b)return;const u=r.tr,m=Kt({state:r,transaction:u});return re({editor:n,state:m,from:Math.max(l-1,0),to:p.b,rule:t})&&u.steps.length?u:void 0}})))}function ie(t){const e=[],{nodeExtensions:n,markExtensions:o}=St(t),r=[...n,...o],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return t.forEach((t=>{const n=u(t,"addGlobalAttributes",{name:t.name,options:t.options,storage:t.storage});n&&n().forEach((t=>{t.types.forEach((n=>{Object.entries(t.attributes).forEach((([t,o])=>{e.push({type:n,name:t,attribute:{...s,...o}})}))}))}))})),r.forEach((t=>{const n={name:t.name,options:t.options,storage:t.storage},o=u(t,"addAttributes",n);if(!o)return;const r=o();Object.entries(r).forEach((([n,o])=>{e.push({type:t.name,name:n,attribute:{...s,...o}})}))})),e}function ae(...t){return t.filter((t=>!!t)).reduce(((t,e)=>{const n={...t};return Object.entries(e).forEach((([t,e])=>{n[t]?n[t]="class"===t?[n[t],e].join(" "):"style"===t?[n[t],e].join("; "):e:n[t]=e})),n}),{})}function ce(t,e){return e.filter((t=>t.attribute.rendered)).map((e=>e.attribute.renderHTML?e.attribute.renderHTML(t.attrs)||{}:{[e.name]:t.attrs[e.name]})).reduce(((t,e)=>ae(t,e)),{})}function de(t,e){return t.style?t:{...t,getAttrs:n=>{const o=t.getAttrs?t.getAttrs(n):t.attrs;if(!1===o)return!1;const r=e.filter((t=>t.attribute.rendered)).reduce(((t,e)=>{const o=e.attribute.parseHTML?e.attribute.parseHTML(n):function(t){return"string"!=typeof t?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):"true"===t||"false"!==t&&t}(n.getAttribute(e.name));return $(o)&&console.warn(`[tiptap warn]: BREAKING CHANGE: "parseHTML" for your attribute "${e.name}" returns an object but should return the value itself. If this is expected you can ignore this message. This warning will be removed in one of the next releases. Further information: https://github.com/ueberdosis/tiptap/issues/1863`),null==o?t:{...t,[e.name]:o}}),{});return{...o,...r}}}}function le(t){return Object.fromEntries(Object.entries(t).filter((([t,e])=>("attrs"!==t||!function(t={}){return 0===Object.keys(t).length&&t.constructor===Object}(e))&&null!=e)))}function pe(t){var e;const n=ie(t),{nodeExtensions:o,markExtensions:s}=St(t),i=null===(e=o.find((t=>u(t,"topNode"))))||void 0===e?void 0:e.name,a=Object.fromEntries(o.map((e=>{const o=n.filter((t=>t.type===e.name)),r={name:e.name,options:e.options,storage:e.storage},s=le({...t.reduce(((t,n)=>{const o=u(n,"extendNodeSchema",r);return{...t,...o?o(e):{}}}),{}),content:p(u(e,"content",r)),marks:p(u(e,"marks",r)),group:p(u(e,"group",r)),inline:p(u(e,"inline",r)),atom:p(u(e,"atom",r)),selectable:p(u(e,"selectable",r)),draggable:p(u(e,"draggable",r)),code:p(u(e,"code",r)),defining:p(u(e,"defining",r)),isolating:p(u(e,"isolating",r)),attrs:Object.fromEntries(o.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),i=p(u(e,"parseHTML",r));i&&(s.parseDOM=i.map((t=>de(t,o))));const a=u(e,"renderHTML",r);a&&(s.toDOM=t=>a({node:t,HTMLAttributes:ce(t,o)}));const c=u(e,"renderText",r);return c&&(s.toText=c),[e.name,s]}))),c=Object.fromEntries(s.map((e=>{const o=n.filter((t=>t.type===e.name)),r={name:e.name,options:e.options,storage:e.storage},s=le({...t.reduce(((t,n)=>{const o=u(n,"extendMarkSchema",r);return{...t,...o?o(e):{}}}),{}),inclusive:p(u(e,"inclusive",r)),excludes:p(u(e,"excludes",r)),group:p(u(e,"group",r)),spanning:p(u(e,"spanning",r)),code:p(u(e,"code",r)),attrs:Object.fromEntries(o.map((t=>{var e;return[t.name,{default:null===(e=null==t?void 0:t.attribute)||void 0===e?void 0:e.default}]})))}),i=p(u(e,"parseHTML",r));i&&(s.parseDOM=i.map((t=>de(t,o))));const a=u(e,"renderHTML",r);return a&&(s.toDOM=t=>a({mark:t,HTMLAttributes:ce(t,o)})),[e.name,s]})));return new r.Schema({topNode:i,nodes:a,marks:c})}function ue(t,e){return e.nodes[t]||e.marks[t]||null}function me(t,e){return Array.isArray(e)?e.some((e=>("string"==typeof e?e:e.name)===t.name)):e}class he{constructor(t,e){this.splittableMarks=[],this.editor=e,this.extensions=he.resolve(t),this.schema=pe(this.extensions),this.extensions.forEach((t=>{var e;this.editor.extensionStorage[t.name]=t.storage;const n={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:ue(t.name,this.schema)};"mark"===t.type&&(null===(e=p(u(t,"keepOnSplit",n)))||void 0===e||e)&&this.splittableMarks.push(t.name);const o=u(t,"onBeforeCreate",n);o&&this.editor.on("beforeCreate",o);const r=u(t,"onCreate",n);r&&this.editor.on("create",r);const s=u(t,"onUpdate",n);s&&this.editor.on("update",s);const i=u(t,"onSelectionUpdate",n);i&&this.editor.on("selectionUpdate",i);const a=u(t,"onTransaction",n);a&&this.editor.on("transaction",a);const c=u(t,"onFocus",n);c&&this.editor.on("focus",c);const d=u(t,"onBlur",n);d&&this.editor.on("blur",d);const l=u(t,"onDestroy",n);l&&this.editor.on("destroy",l)}))}static resolve(t){const e=he.sort(he.flatten(t)),n=function(t){const e=t.filter(((e,n)=>t.indexOf(e)!==n));return[...new Set(e)]}(e.map((t=>t.name)));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map((t=>`'${t}'`)).join(", ")}]. This can lead to issues.`),e}static flatten(t){return t.map((t=>{const e=u(t,"addExtensions",{name:t.name,options:t.options,storage:t.storage});return e?[t,...this.flatten(e())]:t})).flat(10)}static sort(t){return t.sort(((t,e)=>{const n=u(t,"priority")||100,o=u(e,"priority")||100;return n>o?-1:n<o?1:0}))}get commands(){return this.extensions.reduce(((t,e)=>{const n=u(e,"addCommands",{name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:ue(e.name,this.schema)});return n?{...t,...n()}:t}),{})}get plugins(){const{editor:t}=this,e=he.sort([...this.extensions].reverse()),n=[],o=[],r=e.map((e=>{const r={name:e.name,options:e.options,storage:e.storage,editor:t,type:ue(e.name,this.schema)},s=[],i=u(e,"addKeyboardShortcuts",r);if(i){const e=Object.fromEntries(Object.entries(i()).map((([e,n])=>[e,()=>n({editor:t})]))),n=a.keymap(e);s.push(n)}const c=u(e,"addInputRules",r);me(e,t.options.enableInputRules)&&c&&n.push(...c());const d=u(e,"addPasteRules",r);me(e,t.options.enablePasteRules)&&d&&o.push(...d());const l=u(e,"addProseMirrorPlugins",r);if(l){const t=l();s.push(...t)}return s})).flat();return[ne({editor:t,rules:n}),...se({editor:t,rules:o}),...r]}get attributes(){return ie(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=St(this.extensions);return Object.fromEntries(e.filter((t=>!!u(t,"addNodeView"))).map((e=>{const n=this.attributes.filter((t=>t.type===e.name)),o={name:e.name,options:e.options,storage:e.storage,editor:t,type:k(e.name,this.schema)},r=u(e,"addNodeView",o);return r?[e.name,(o,s,i,a)=>{const c=ce(o,n);return r()({editor:t,node:o,getPos:i,decorations:a,HTMLAttributes:c,extension:e})}]:[]})))}}class fe{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=p(u(this,"addOptions",{name:this.name}))),this.storage=p(u(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new fe(t)}configure(t={}){const e=this.extend();return e.options=d(this.options,t),e.storage=p(u(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new fe(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=p(u(e,"addOptions",{name:e.name})),e.storage=p(u(e,"addStorage",{name:e.name,options:e.options})),e}}class ge{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=p(u(this,"addOptions",{name:this.name}))),this.storage=p(u(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new ge(t)}configure(t={}){const e=this.extend();return e.options=d(this.options,t),e.storage=p(u(e,"addStorage",{name:e.name,options:e.options})),e}extend(t={}){const e=new ge(t);return e.parent=this,this.child=e,e.name=t.name?t.name:e.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${e.name}".`),e.options=p(u(e,"addOptions",{name:e.name})),e.storage=p(u(e,"addStorage",{name:e.name,options:e.options})),e}}function be(t,e,n){const o=[];return t===e?n.resolve(t).marks().forEach((e=>{const r=A(n.resolve(t-1),e.type);r&&o.push({mark:e,...r})})):n.nodesBetween(t,e,((t,e)=>{o.push(...t.marks.map((n=>({from:e,to:e+t.nodeSize,mark:n}))))})),o}function ye(t){return pe(he.resolve(t))}function ve(t){const e=function(t,e=JSON.stringify){const n={};return t.filter((t=>{const o=e(t);return!Object.prototype.hasOwnProperty.call(n,o)&&(n[o]=!0)}))}(t);return 1===e.length?e:e.filter(((t,n)=>!e.filter(((t,e)=>e!==n)).some((e=>t.oldRange.from>=e.oldRange.from&&t.oldRange.to<=e.oldRange.to&&t.newRange.from>=e.newRange.from&&t.newRange.to<=e.newRange.to))))}t.CommandManager=Vt,t.Editor=class extends class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach((t=>t.apply(this,e))),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter((t=>t!==e)):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout((()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))}),0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(t){const e=document.querySelector("style[data-tiptap-style]");if(null!==e)return e;const n=document.createElement("style");return n.setAttribute("data-tiptap-style",""),n.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(n),n}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}'))}setOptions(t={}){this.options={...this.options,...t},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,e){const n=l(e)?e(t,this.state.plugins):[...this.state.plugins,t],o=this.state.reconfigure({plugins:n});this.view.updateState(o)}unregisterPlugin(t){if(this.isDestroyed)return;const e="string"==typeof t?`${t}$`:t.key,n=this.state.reconfigure({plugins:this.state.plugins.filter((t=>!t.key.startsWith(e)))});this.view.updateState(n)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(qt):[],...this.options.extensions].filter((t=>["extension","node","mark"].includes(null==t?void 0:t.type)));this.extensionManager=new he(t,this)}createCommandManager(){this.commandManager=new Vt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=lt(this.options.content,this.schema,this.options.parseOptions),n=L(t,this.options.autofocus);this.view=new i.EditorView(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:e.EditorState.create({doc:t,selection:n})});const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach((t=>{var e;return null===(e=this.capturedTransaction)||void 0===e?void 0:e.step(t)})):void(this.capturedTransaction=t);const e=this.state.apply(t),n=!this.state.selection.eq(e.selection);this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const o=t.getMeta("focus"),r=t.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:t}),r&&this.emit("blur",{editor:this,event:r.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Ut(this.state,t)}isActive(t,e){const n="string"==typeof t?t:null,o="string"==typeof t?e:t;return Xt(this.state,n,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Yt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e="\n\n",textSerializers:n={}}=t||{};return Qt(this.state.doc,{blockSeparator:e,textSerializers:{...n,...f(this.schema)}})}get isEmpty(){return Zt(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}},t.Extension=m,t.InputRule=te,t.Mark=ge,t.Node=fe,t.NodeView=class{constructor(t,e,n){this.isDragging=!1,this.component=t,this.editor=e.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=e.extension,this.node=e.node,this.decorations=e.decorations,this.getPos=e.getPos,this.mount()}mount(){}get dom(){return null}get contentDOM(){return null}onDragStart(t){var n,o,r;const{view:s}=this.editor,i=t.target,a=3===i.nodeType?null===(n=i.parentElement)||void 0===n?void 0:n.closest("[data-drag-handle]"):i.closest("[data-drag-handle]");if(!this.dom||(null===(o=this.contentDOM)||void 0===o?void 0:o.contains(i))||!a)return;let c=0,d=0;if(this.dom!==a){const e=this.dom.getBoundingClientRect(),n=a.getBoundingClientRect();c=n.x-e.x+t.offsetX,d=n.y-e.y+t.offsetY}null===(r=t.dataTransfer)||void 0===r||r.setDragImage(this.dom,c,d);const l=e.NodeSelection.create(s.state.doc,this.getPos()),p=s.state.tr.setSelection(l);s.dispatch(p)}stopEvent(t){var n;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const o=t.target;if(!this.dom.contains(o)||(null===(n=this.contentDOM)||void 0===n?void 0:n.contains(o)))return!1;const r="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(o.tagName)||o.isContentEditable)&&!r)return!0;const{isEditable:s}=this.editor,{isDragging:i}=this,a=!!this.node.type.spec.draggable,c=e.NodeSelection.isSelectable(this.node),d="copy"===t.type,l="paste"===t.type,p="cut"===t.type,u="mousedown"===t.type,m=t.type.startsWith("drag");if(!a&&c&&m&&t.preventDefault(),a&&m&&!i)return t.preventDefault(),!1;if(a&&s&&!i&&u){const t=o.closest("[data-drag-handle]");t&&(this.dom===t||this.dom.contains(t))&&(this.isDragging=!0,document.addEventListener("dragend",(()=>{this.isDragging=!1}),{once:!0}),document.addEventListener("mouseup",(()=>{this.isDragging=!1}),{once:!0}))}return!(i||r||d||l||p||u&&c)}ignoreMutation(t){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:t}):!(!this.node.isLeaf&&!this.node.isAtom)||"selection"!==t.type&&(!(this.dom.contains(t.target)&&"childList"===t.type&&I()&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every((t=>t.isContentEditable)))&&(this.contentDOM===t.target&&"attributes"===t.type||!this.contentDOM.contains(t.target))))}updateAttributes(t){this.editor.commands.command((({tr:e})=>{const n=this.getPos();return e.setNodeMarkup(n,void 0,{...this.node.attrs,...t}),!0}))}deleteNode(){const t=this.getPos(),e=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:e})}},t.PasteRule=oe,t.Tracker=class{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let e=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce(((t,n)=>{const o=n.getMap().mapResult(t);return o.deleted&&(e=!0),o.pos}),t),deleted:e}}},t.callOrReturn=p,t.combineTransactionSteps=function(t,e){const o=new n.Transform(t);return e.forEach((t=>{t.steps.forEach((t=>{o.step(t)}))})),o},t.defaultBlockAt=function(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null},t.escapeForRegEx=function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")},t.extensions=qt,t.findChildren=function(t,e){const n=[];return t.descendants(((t,o)=>{e(t)&&n.push({node:t,pos:o})})),n},t.findChildrenInRange=function(t,e,n){const o=[];return t.nodesBetween(e.from,e.to,((t,e)=>{n(t)&&o.push({node:t,pos:e})})),o},t.findParentNode=Mt,t.findParentNodeClosestToPos=_t,t.generateHTML=function(t,e){const n=ye(e);return Yt(r.Node.fromJSON(n,t).content,n)},t.generateJSON=function(t,e){const n=ye(e),o=V(t);return r.DOMParser.fromSchema(n).parse(o).toJSON()},t.generateText=function(t,e,n){const{blockSeparator:o="\n\n",textSerializers:s={}}=n||{},i=ye(e);return Qt(r.Node.fromJSON(i,t),{blockSeparator:o,textSerializers:{...s,...f(i)}})},t.getAttributes=Ut,t.getChangedRanges=function(t){const{mapping:e,steps:n}=t,o=[];return e.maps.forEach(((t,r)=>{const s=[];if(t.ranges.length)t.forEach(((t,e)=>{s.push({from:t,to:e})}));else{const{from:t,to:e}=n[r];if(void 0===t||void 0===e)return;s.push({from:t,to:e})}s.forEach((({from:t,to:n})=>{const s=e.slice(r).map(t,-1),i=e.slice(r).map(n),a=e.invert().map(s,-1),c=e.invert().map(i);o.push({oldRange:{from:a,to:c},newRange:{from:s,to:i}})}))})),ve(o)},t.getDebugJSON=function t(e,n=0){const o=e.type===e.type.schema.topNodeType?0:1,r=n,s=r+e.nodeSize,i=e.marks.map((t=>{const e={type:t.type.name};return Object.keys(t.attrs).length&&(e.attrs={...t.attrs}),e})),a={...e.attrs},c={type:e.type.name,from:r,to:s};return Object.keys(a).length&&(c.attrs=a),i.length&&(c.marks=i),e.content.childCount&&(c.content=[],e.forEach(((e,r)=>{var s;null===(s=c.content)||void 0===s||s.push(t(e,n+r+o))}))),e.text&&(c.text=e.text),c},t.getExtensionField=u,t.getHTMLFromFragment=Yt,t.getMarkAttributes=ut,t.getMarkRange=A,t.getMarkType=T,t.getMarksBetween=be,t.getNodeAttributes=Gt,t.getNodeType=k,t.getSchema=ye,t.getText=Qt,t.getTextBetween=h,t.inputRulesPlugin=ne,t.isActive=Xt,t.isList=Ot,t.isMarkActive=Pt,t.isNodeActive=Y,t.isNodeEmpty=Zt,t.isNodeSelection=function(t){return $(t)&&t instanceof e.NodeSelection},t.isTextSelection=B,t.markInputRule=function(t){return new te({find:t.find,handler:({state:e,range:n,match:o})=>{const r=p(t.getAttributes,void 0,o);if(!1===r||null===r)return null;const{tr:s}=e,i=o[o.length-1],a=o[0];let c=n.to;if(i){const o=a.search(/\S/),d=n.from+a.indexOf(i),l=d+i.length;if(be(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>d)).length)return null;l<n.to&&s.delete(l,n.to),d>n.from&&s.delete(n.from+o,d),c=n.from+o+i.length,s.addMark(n.from+o,c,t.type.create(r||{})),s.removeStoredMark(t.type)}}})},t.markPasteRule=function(t){return new oe({find:t.find,handler:({state:e,range:n,match:o})=>{const r=p(t.getAttributes,void 0,o);if(!1===r||null===r)return null;const{tr:s}=e,i=o[o.length-1],a=o[0];let c=n.to;if(i){const o=a.search(/\S/),d=n.from+a.indexOf(i),l=d+i.length;if(be(n.from,n.to,e.doc).filter((e=>e.mark.type.excluded.find((n=>n===t.type&&n!==e.mark.type)))).filter((t=>t.to>d)).length)return null;l<n.to&&s.delete(l,n.to),d>n.from&&s.delete(n.from+o,d),c=n.from+o+i.length,s.addMark(n.from+o,c,t.type.create(r||{})),s.removeStoredMark(t.type)}}})},t.mergeAttributes=ae,t.nodeInputRule=function(t){return new te({find:t.find,handler:({state:e,range:n,match:o})=>{const r=p(t.getAttributes,void 0,o)||{},{tr:s}=e,i=n.from;let a=n.to;if(o[1]){let e=i+o[0].lastIndexOf(o[1]);e>a?e=a:a=e+o[1].length;const n=o[0][o[0].length-1];s.insertText(n,i+o[0].length-1),s.replaceWith(e,a,t.type.create(r))}else o[0]&&s.replaceWith(i,a,t.type.create(r))}})},t.pasteRulesPlugin=se,t.posToDOMRect=function(t,e,n){const o=t.state.doc.content.size,r=D(e,0,o),s=D(n,0,o),i=t.coordsAtPos(r),a=t.coordsAtPos(s,-1),c=Math.min(i.top,a.top),d=Math.max(i.bottom,a.bottom),l=Math.min(i.left,a.left),p=Math.max(i.right,a.right),u={top:c,bottom:d,left:l,right:p,width:p-l,height:d-c,x:l,y:c};return{...u,toJSON:()=>u}},t.textInputRule=function(t){return new te({find:t.find,handler:({state:e,range:n,match:o})=>{let r=t.replace,s=n.from;const i=n.to;if(o[1]){const t=o[0].lastIndexOf(o[1]);r+=o[0].slice(t+o[1].length),s+=t;const e=s-i;e>0&&(r=o[0].slice(t-e,t)+r,s=i)}e.tr.insertText(r,s,i)}})},t.textPasteRule=function(t){return new oe({find:t.find,handler:({state:e,range:n,match:o})=>{let r=t.replace,s=n.from;const i=n.to;if(o[1]){const t=o[0].lastIndexOf(o[1]);r+=o[0].slice(t+o[1].length),s+=t;const e=s-i;e>0&&(r=o[0].slice(t-e,t)+r,s=i)}e.tr.insertText(r,s,i)}})},t.textblockTypeInputRule=function(t){return new te({find:t.find,handler:({state:e,range:n,match:o})=>{const r=e.doc.resolve(n.from),s=p(t.getAttributes,void 0,o)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})},t.wrappingInputRule=function(t){return new te({find:t.find,handler:({state:e,range:o,match:r})=>{const s=p(t.getAttributes,void 0,r)||{},i=e.tr.delete(o.from,o.to),a=i.doc.resolve(o.from).blockRange(),c=a&&n.findWrapping(a,t.type,s);if(!c)return null;i.wrap(a,c);const d=i.doc.resolve(o.from-1).nodeBefore;d&&d.type===t.type&&n.canJoin(i.doc,o.from-1)&&(!t.joinPredicate||t.joinPredicate(r,d))&&i.join(o.from-1)}})},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("prosemirror-state"),require("prosemirror-transform"),require("prosemirror-commands"),require("prosemirror-model"),require("prosemirror-schema-list"),require("prosemirror-view"),require("prosemirror-keymap")):"function"==typeof define&&define.amd?define(["exports","prosemirror-state","prosemirror-transform","prosemirror-commands","prosemirror-model","prosemirror-schema-list","prosemirror-view","prosemirror-keymap"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["@tiptap/core"]={},t.prosemirrorState,t.prosemirrorTransform,t.prosemirrorCommands,t.prosemirrorModel,t.prosemirrorSchemaList,t.prosemirrorView,t.prosemirrorKeymap),$((function(){console.log("foobar")})),window.tiptap=exports}();
//# sourceMappingURL=tiptap.min.js.map
